<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ResetPasswordForm</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<h2 th:if="${isSuccess}">해당 이메일로 초기화된 비밀번호가 발송되었습니다</h2>
<form th:action="@{/resetPassword}" method="post" th:object="${emailAuthForm}">
    <div>
        <input type="text" th:field="*{email}" placeholder="이메일" required><br>
        <button type="button" onclick="submitEmailForm()">요청</button>
    </div>
    <div th:if="${#fields.hasErrors('certificationCode')}" th:errors="*{certificationCode}"></div>
    <div>
        <input type="text" th:field="*{certificationCode}" placeholder="인증 코드" required><br>
        <button type="submit">인증</button>
    </div>

    <script>
        function submitEmailForm() {
            var email = $("#email").val();

            $.ajax({
                type: "POST",
                url: "/email-certification/send", // POST 요청을 보낼 URL
                data: {email: email}, // 전송할 데이터
                success: function (response) {
                    // 성공적으로 서버로부터 응답을 받은 경우 수행할 작업
                    console.log("Success:", response);
                },
                error: function (request, status, error) {
                    // 서버로 요청을 보내는 중에 오류가 발생한 경우 수행할 작업
                    if (request.status === 400) {
                        alert(request.responseText);
                    }
                }
            });
        }
    </script>
</form>
</body>
</html>